package automation;


import java.awt.AWTException;
import java.awt.Robot;
import java.awt.Toolkit;
import java.awt.datatransfer.Clipboard;
import java.awt.datatransfer.StringSelection;
import java.awt.event.KeyEvent;
import java.io.IOException;
import org.openqa.selenium.By;
import org.openqa.selenium.Keys;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.Dimension;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.testng.annotations.Test;

import java.util.Scanner;
import java.util.concurrent.TimeUnit;


public class FundingFun {
//static WebDriver driver = new FirefoxDriver();
static WebDriver driver;
final String A = ("test.pa1@itgfirm.com");      		  //  username  
final String B = ("usac123!");                 	         //   all passwords the same 
	  String C;                 	//    SAC 
final String E = ("test.pr1@itgfirm.com");            //      username
final String F = ("test.pm1@itgfirm.com");           //	      username
	  String G = ("");     					//	      change to something 
	  String H;  //	      to be used later 
	  String I;
	  int choice = 0;

	@Test (priority = 1)
	public void logIn() throws InterruptedException, IOException {
		Scanner keyboard= new Scanner(System.in);
		System.out.print("Select a fund type:\n1)CAF Phase II\n2)Mobility\n3)RBE\nChoice:");
		choice = keyboard.nextInt();
		keyboard.nextLine();//consume newline left-over from above line
		
		if(choice==1)
		{
			G = "CAF Phase II Monthly Support Information";
			I = "CAF Phase II";
		}
		else if(choice==2)
		{
			G = "Mobility Winning Bid Information";
			I = "Mobility";
		}
		else
		{
			G = "RBE Monthly Support Information";
			I = "RBE";
		}
		
		System.out.print("\nEnter SAC Name: ");
		C = keyboard.nextLine();
		H = C.substring(C.lastIndexOf("-")+2,C.length());
		System.out.println("SAC ID extracted : " + H);
//		System.out.println("Fund Type ---> "+G.substring(0,G.indexOf(" ")));
		
		driver=new FirefoxDriver();
		driver.get("https://portal-hctest.appiancloud.com/suite/tempo/");
		driver.manage().window().maximize();  
		driver.findElement(By.cssSelector(".btn, input.iBlueButton")).click(); 
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.id("un")).sendKeys(A);
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.id("pw")).sendKeys(B);
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.xpath("//input[@type='submit']")).click();
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		System.out.println("User logged in");
	}  
	
	@Test (priority = 2)
	public void records() throws InterruptedException {
		driver.findElement(By.partialLinkText("Records")).click();
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.partialLinkText("SACs")).click();
		Thread.sleep(2000);
		driver.findElement(By.xpath("/html/body/div[7]/div[2]/div/div[2]/div/div[2]/div[2]/div/div/div/div/div[1]/div[2]/input")).sendKeys(H);
		driver.findElement(By.xpath("/html/body/div[7]/div[2]/div/div[2]/div/div[2]/div[2]/div/div/div/div/div[1]/div[2]/input")).sendKeys(Keys.ENTER);
		Thread.sleep(2000);
		driver.findElement(By.partialLinkText(C)).click();
		System.out.println("SAC " + C + " selected");
	} 
	
	@Test (priority = 3)
	public void relatedActions() throws InterruptedException {
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.partialLinkText("Related Actions")).click();
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.partialLinkText("Manage Funding")).click();
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.xpath("//button[contains(.,'Manage "+ I +" Funding')]")).click();
	} 
	
	@Test (priority = 4)
	public void manageFunding() throws InterruptedException, AWTException {
		String text = "upload.xlsx";
		StringSelection stringSelection = new StringSelection(text);
		Clipboard clipboard = Toolkit.getDefaultToolkit().getSystemClipboard();
		clipboard.setContents(stringSelection, stringSelection);
		Robot robot = new Robot();
		
		if(choice==1)
		{
			
			driver.findElement(By.xpath("//input[@type='file']")).click();
			Thread.sleep(5000);
			robot.keyPress(KeyEvent.VK_CONTROL);
			robot.keyPress(KeyEvent.VK_V);
			robot.keyRelease(KeyEvent.VK_V);
			robot.keyRelease(KeyEvent.VK_CONTROL);
			Thread.sleep(2000);
			robot.keyPress(KeyEvent.VK_ENTER);
			Thread.sleep(1000);
			
			  driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
			  driver.findElement(By.xpath("//label[contains(text(),'CAF Phase I FHCS Amount (Annual)')]")).sendKeys("425000");
			 driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
			 driver.findElement(By.xpath("//label[contains(text(),'CAF Phase II CACM Amount (Annual)')]")).sendKeys("3455000");
			 driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
			driver.findElement(By.xpath("//label[contains(text(),'Transition Duration (Months)')]")).sendKeys("12");
			 //driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
			 //driver.findElement(By.xpath("//label[contains(text(),'Effective Start Month (YYYYMM)')]")).sendKeys("201810");
			// driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
			 //driver.findElement(By.xpath("//label[contains(text(),'Lump Sum Disbursement Month (YYYYMM)')]")).sendKeys("201810");
			Thread.sleep(2000);
			driver.findElement(By.xpath("//label[contains(text(),'Comments')]")).sendKeys("Comments appear here");
			Thread.sleep(4000);
			driver.findElement(By.xpath("//button[contains(.,'Submit for Review')]")).click();
			 
		}
		else if(choice==2)
		{
			driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS); 
			driver.findElement(By.xpath("//label[contains(text(),'Winning Bid Amount')]")).sendKeys("5332060"); 
			driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
			driver.findElement(By.xpath("//label[contains(text(),'Payment Start Date')]")).sendKeys("12/12/2016");
			driver.findElement(By.xpath("//label[contains(text(),'Payment Start Date')]")).sendKeys(Keys.ENTER); 
			Thread.sleep(1000);  
			driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
			driver.findElement(By.xpath("//button[contains(.,'Submit for Review')]")).click();
		}
		else
		{
			driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
			driver.findElement(By.xpath("//label[contains(text(),'Winning Bid Amount')]")).sendKeys("1534632");
			driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
			driver.findElement(By.xpath("/html/body/div[7]/div[2]/div/div[2]/div/div[2]/div[2]/div/div/div/form/div[2]/div/div/div/div/div/div/div[2]/div[3]/div/div/div[2]/div/div/div/div/div/div/div[1]/div/select")).sendKeys("1 - High Performance Projects"+Keys.TAB);
			Thread.sleep(1000);
			driver.findElement(By.xpath("//label[contains(text(),'Effective Start Month')]")).sendKeys("201612");
			Thread.sleep(1000);
			driver.findElement(By.xpath("//button[contains(.,'Submit for Review')]")).click();
		}
	}
	
	@Test (priority = 5)
	public void signOutPa() throws InterruptedException, IOException {
		Thread.sleep(2000);
		driver.findElement(By.cssSelector(".appian-body .GJEWJWHDIFC")).click();
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.partialLinkText("Sign Out")).click();
	}  
	
	@Test (priority = 6)
	public void logInPrReview() throws InterruptedException {
		driver.findElement(By.cssSelector(".btn, input.iBlueButton")).click(); 
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.id("un")).sendKeys(E);
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.id("pw")).sendKeys(B);
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.xpath("//input[@type='submit']")).click();
		Thread.sleep(8000);	
	} 
	
	@Test (priority = 7)
	public void tasksPr () throws InterruptedException, IOException {
		driver.findElement(By.partialLinkText("Tasks")).click();
		Thread.sleep(1000);
		driver.findElement(By.partialLinkText("Review and Approve " + G + " (" + C + ")")).click();
		Thread.sleep(1000);
		driver.findElement(By.xpath("//button[contains(.,'Accept')]")).click();
		Thread.sleep(1000);
		driver.findElement(By.xpath("//label[contains(text(),'Approve')]")).click();
		Thread.sleep(1000);
		driver.findElement(By.xpath("//label[contains(text(),'Review Feedback')]")).sendKeys("Reviewed and Approved");
		Thread.sleep(1000);
		driver.findElement(By.xpath("//button[contains(.,'Submit Decision')]")).click();
	}
	
	@Test (priority = 8)
	public void signOutPr() throws InterruptedException, IOException {
		Thread.sleep(2000);
		driver.findElement(By.cssSelector(".appian-body .GJEWJWHDIFC")).click();
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.partialLinkText("Sign Out")).click();
	}
	
	@Test (priority = 9)
	public void logInPmReview() throws InterruptedException {
		driver.findElement(By.cssSelector(".btn, input.iBlueButton")).click(); 
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.id("un")).sendKeys(F);
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.id("pw")).sendKeys(B);
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.xpath("//input[@type='submit']")).click();
		Thread.sleep(8000);	
	} 
	
	@Test (priority = 10)
	public void tasksPm () throws InterruptedException, IOException {
		driver.findElement(By.partialLinkText("Tasks")).click();
		Thread.sleep(1000);
		driver.findElement(By.partialLinkText("Review and Approve " + G + " (" + C + ")")).click();
		Thread.sleep(1000);
		driver.findElement(By.xpath("//button[contains(.,'Accept')]")).click();
		Thread.sleep(1000);
		driver.findElement(By.xpath("//label[contains(text(),'Approve')]")).click();
//		driver.findElement(By.xpath("/html/body/div[7]/div[2]/div/div[2]/div/div[2]/div[2]/div/div/div/div/div[2]/form/div[2]/div/div/div/div/div/div/div[11]/div[3]/div/div/div/div/div/div/div/div/div[1]/div/div/span[1]/input")).click();
		Thread.sleep(1000);
		driver.findElement(By.xpath("//label[contains(text(),'Approval Feedback')]")).sendKeys("Reviewed and Approved");
		Thread.sleep(1000);
		driver.findElement(By.xpath("//button[contains(.,'Submit Decision')]")).click();
	}
	
	@Test (priority = 11)
	public void signOutPm() throws InterruptedException, IOException {
		Thread.sleep(2000);
		driver.findElement(By.cssSelector(".appian-body .GJEWJWHDIFC")).click();
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.partialLinkText("Sign Out")).click();
	}
	
	
	@Test (priority = 12)
	public void logInPa() throws InterruptedException {
		driver.findElement(By.cssSelector(".btn, input.iBlueButton")).click(); 
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.id("un")).sendKeys(A);
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.id("pw")).sendKeys(B);
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.xpath("//input[@type='submit']")).click();
		Thread.sleep(8000);	
	} 
	
	@Test (priority = 13)
	public void recordsCheck() throws InterruptedException {
		driver.findElement(By.partialLinkText("Records")).click();
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.partialLinkText("SACs")).click();
		Thread.sleep(2000);
		driver.findElement(By.xpath("/html/body/div[7]/div[2]/div/div[2]/div/div[2]/div[2]/div/div/div/div/div[1]/div[2]/input")).sendKeys(H);
		driver.findElement(By.xpath("/html/body/div[7]/div[2]/div/div[2]/div/div[2]/div[2]/div/div/div/div/div[1]/div[2]/input")).sendKeys(Keys.ENTER);
		Thread.sleep(2000);
		driver.findElement(By.partialLinkText(C)).click();
		System.out.println("SAC " + C + " selected");
	}

}