package automation;


import java.awt.AWTException;
import java.awt.Robot;
import java.awt.Toolkit;
import java.awt.datatransfer.Clipboard;
import java.awt.datatransfer.StringSelection;
import java.awt.event.KeyEvent;
import java.io.IOException;
import org.openqa.selenium.By;
import org.openqa.selenium.Keys;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.Dimension;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.testng.annotations.Test;

import java.util.Scanner;
import java.util.concurrent.TimeUnit;


public class LOC {
static WebDriver driver;
final String A = ("test.lr2@itgfirm.com");      		  //  username  
final String B = ("usac123!");                 	         //   all passwords the same 
	  String C;                 						//    SAC 
final String E = ("test.lr1@itgfirm.com");             //     username
final String F = ("test.lap1@itgfirm.com");           //	  username
	  String G;     					
	  String H;  
	  String I;
	  String Tier = ("Tier 3"); 
	  int choice = 0;

	@Test (priority = 1)
	public void logIn() throws InterruptedException, IOException {
		Scanner keyboard= new Scanner(System.in);
		System.out.print("Select a fund type:\n1)RBE \n2)Mobility\n3)RBE & M\n4)Mobility & R\nChoice:");
		choice = keyboard.nextInt();
		keyboard.nextLine();//consume newline left-over from above line
		
		if(choice==1)
		{
			G = "RBE";
			
		}
		else if(choice==2)
		{
			G = "Mobility";
			
		}
		else if (choice==3)
		{
			G = "RBE & Mobility";
			
		}
		else
		{
			G = "RBE & Mobility";
			
		}
		
		System.out.print("\nEnter SAC Name: ");
		C = keyboard.nextLine();
		H = C.substring(C.lastIndexOf("-")+2,C.length());
		System.out.println("SAC ID extracted : " + H);
//		System.out.println("Fund Type ---> "+G.substring(0,G.indexOf(" ")));
		
		System.out.print("\nEnter LOC Number: ");
		 I = keyboard.nextLine();
		
		driver=new FirefoxDriver();
		driver.get("https://portal-hctest.appiancloud.com/suite/tempo/");
		driver.manage().window().maximize(); 
		driver.findElement(By.cssSelector(".btn, input.iBlueButton")).click(); 
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.id("un")).sendKeys(A);
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.id("pw")).sendKeys(B);
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.xpath("//input[@type='submit']")).click();
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		System.out.println("User logged in");
	}  
	@Test (priority = 2)
	public void records() throws InterruptedException {
		driver.findElement(By.partialLinkText("Records")).click();
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.partialLinkText("SACs")).click();
		Thread.sleep(2000);
		driver.findElement(By.xpath("/html/body/div[7]/div[2]/div/div[2]/div/div[2]/div[2]/div/div/div/div/div[1]/div[2]/input")).sendKeys(H);
		driver.findElement(By.xpath("/html/body/div[7]/div[2]/div/div[2]/div/div[2]/div[2]/div/div/div/div/div[1]/div[2]/input")).sendKeys(Keys.ENTER);
		Thread.sleep(2000);
		driver.findElement(By.partialLinkText(C)).click();
		System.out.println("SAC " + C + " selected");
	} 
	
	@Test (priority = 3)
	public void relatedActions() throws InterruptedException {
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.partialLinkText("Related Actions")).click();
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.partialLinkText("Manage Letter of Credit")).click();
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.xpath("//button[contains(.,'Add New Letter of Credit')]")).click();
		Thread.sleep(2000);
		
	} 
	
	@Test (priority = 4)
	public void manageDefaults() throws InterruptedException, AWTException {
		String text = "upload.xlsx";
		StringSelection stringSelection = new StringSelection(text);
		Clipboard clipboard = Toolkit.getDefaultToolkit().getSystemClipboard();
		clipboard.setContents(stringSelection, stringSelection);
		Robot robot = new Robot();
		
		if(choice==1)
		{
		driver.findElement(By.xpath("//input[@type='file']")).click();
		Thread.sleep(5000);
		robot.keyPress(KeyEvent.VK_CONTROL);
		robot.keyPress(KeyEvent.VK_V);
		robot.keyRelease(KeyEvent.VK_V);
		robot.keyRelease(KeyEvent.VK_CONTROL);
		Thread.sleep(2000);
		robot.keyPress(KeyEvent.VK_ENTER);
		Thread.sleep(1000);
		driver.findElement(By.xpath("//label[contains(text(),'LOC Number')]")).sendKeys(I);
		Thread.sleep(2000);
		driver.findElement(By.xpath("//label[contains(text(),'Yes')]")).click();
		Thread.sleep(2000);
		driver.findElement(By.xpath("//label[contains(text(),'LOC Amount')]")).sendKeys("12300");
		Thread.sleep(2000);
		driver.findElement(By.xpath("//label[contains(text(),'LOC Description')]")).sendKeys("Sample LOC");
		Thread.sleep(2000); 
		driver.findElement(By.xpath("//label[contains(text(),'LOC Coverage End Date (YYYYMM)')]")).sendKeys("201910");
		Thread.sleep(2000); 
		driver.findElement(By.xpath("//label[contains(text(),'Evergreen')]")).click();
		Thread.sleep(1000); 
		driver.findElement(By.xpath("//label[contains(text(),'USAC Received Date')]")).sendKeys("12/08/2015");
		driver.findElement(By.xpath("//label[contains(text(),'USAC Received Date')]")).sendKeys(Keys.ENTER);
		Thread.sleep(2000);
		driver.findElement(By.xpath("//label[contains(text(),'Initial Due Date')]")).sendKeys("12/10/2015");
		driver.findElement(By.xpath("//label[contains(text(),'Initial Due Date')]")).sendKeys(Keys.ENTER);
		Thread.sleep(2000);
		driver.findElement(By.xpath("//label[contains(text(),'Expiration Date')]")).sendKeys("12/28/2016");
		driver.findElement(By.xpath("//label[contains(text(),'Expiration Date')]")).sendKeys(Keys.ENTER);
		Thread.sleep(2000);
		driver.findElement(By.xpath("//label[contains(text(),'Issued Date')]")).sendKeys("11/20/2016");
		driver.findElement(By.xpath("//label[contains(text(),'Issued Date')]")).sendKeys(Keys.ENTER);
		Thread.sleep(2000);
		driver.findElement(By.xpath("//label[contains(text(),'Final Revision Date')]")).sendKeys("12/20/2016");
		driver.findElement(By.xpath("//label[contains(text(),'Final Revision Date')]")).sendKeys(Keys.ENTER);
		Thread.sleep(2000);
		driver.findElement(By.xpath("//label[contains(text(),'Bank Name')]")).sendKeys("BOA");
		Thread.sleep(2000);
		driver.findElement(By.xpath("//button[contains(.,'Submit for Review')]")).click();
		Thread.sleep(4000);	
			
			
			
		}
		else if(choice==2)
		{
		
		driver.findElement(By.xpath("//input[@type='file']")).click();
		Thread.sleep(5000);
		robot.keyPress(KeyEvent.VK_CONTROL);
		robot.keyPress(KeyEvent.VK_V);
		robot.keyRelease(KeyEvent.VK_V);
		robot.keyRelease(KeyEvent.VK_CONTROL);
		Thread.sleep(2000);
		robot.keyPress(KeyEvent.VK_ENTER);
		Thread.sleep(1000);
		driver.findElement(By.xpath("//label[contains(text(),'LOC Number')]")).sendKeys(I);
		Thread.sleep(2000);
		driver.findElement(By.xpath("//label[contains(text(),'Yes')]")).click();
		Thread.sleep(2000);
		//driver.findElement(By.xpath("//label[contains(text(),'LOC Amount')]")).click();
		//Thread.sleep(2000);
		driver.findElement(By.xpath("//label[contains(text(),'LOC Amount')]")).sendKeys("12344245");
		Thread.sleep(1000);
		driver.findElement(By.xpath("//label[contains(text(),'LOC Description')]")).sendKeys("Sample LOC");
		Thread.sleep(1000);
		driver.findElement(By.xpath("/html/body/div[7]/div[2]/div/div[2]/div/div[2]/div[2]/div/div/div/form/div[2]/div/div/div/div/div/div/div[1]/div[3]/div/div/div[1]/div/div/div[5]/div/div/div/div[1]/div/select")).sendKeys("Payments 2&3");
		Thread.sleep(1000); 
		driver.findElement(By.xpath("//label[contains(text(),'Evergreen')]")).click();
		Thread.sleep(1000); 
		driver.findElement(By.xpath("//label[contains(text(),'USAC Received Date')]")).sendKeys("12/08/2015");
		driver.findElement(By.xpath("//label[contains(text(),'USAC Received Date')]")).sendKeys(Keys.ENTER);
		Thread.sleep(1000);
		driver.findElement(By.xpath("//label[contains(text(),'Initial Due Date')]")).sendKeys("12/10/2015");
		driver.findElement(By.xpath("//label[contains(text(),'Initial Due Date')]")).sendKeys(Keys.ENTER);
		Thread.sleep(1000);
		driver.findElement(By.xpath("//label[contains(text(),'Expiration Date')]")).sendKeys("12/28/2016");
		driver.findElement(By.xpath("//label[contains(text(),'Expiration Date')]")).sendKeys(Keys.ENTER);
		Thread.sleep(1000);
		driver.findElement(By.xpath("//label[contains(text(),'Issued Date')]")).sendKeys("12/20/2016");
		driver.findElement(By.xpath("//label[contains(text(),'Issued Date')]")).sendKeys(Keys.ENTER);
		Thread.sleep(1000);
		driver.findElement(By.xpath("//label[contains(text(),'Final Revision Date')]")).sendKeys("12/20/2016");
		driver.findElement(By.xpath("//label[contains(text(),'Final Revision Date')]")).sendKeys(Keys.ENTER);
		Thread.sleep(1000);
		driver.findElement(By.xpath("//label[contains(text(),'Bank Name')]")).sendKeys("BOA");
		Thread.sleep(1000);
		driver.findElement(By.xpath("//button[contains(.,'Submit for Review')]")).click();
		Thread.sleep(4000);
			
			
		}
		else if(choice==3)
		{
			driver.findElement(By.xpath("//input[@type='file']")).click();
			Thread.sleep(5000);
			robot.keyPress(KeyEvent.VK_CONTROL);
			robot.keyPress(KeyEvent.VK_V);
			robot.keyRelease(KeyEvent.VK_V);
			robot.keyRelease(KeyEvent.VK_CONTROL);
			Thread.sleep(2000);
			robot.keyPress(KeyEvent.VK_ENTER);
			Thread.sleep(1000);
			driver.findElement(By.xpath("//label[contains(text(),'LOC Number')]")).sendKeys(I);
			Thread.sleep(1000);
			driver.findElement(By.xpath("//label[contains(text(),'Yes')]")).click();
			Thread.sleep(2000);
			driver.findElement(By.xpath("//label[contains(text(),'RBE')]")).click();
			Thread.sleep(2000);
			driver.findElement(By.xpath("//label[contains(text(),'LOC Amount')]")).sendKeys("12344245");
			Thread.sleep(2000);
			driver.findElement(By.xpath("//label[contains(text(),'LOC Description')]")).sendKeys("Sample LOC");
			Thread.sleep(2000); 
			driver.findElement(By.xpath("//label[contains(text(),'LOC Coverage End Date (YYYYMM)')]")).sendKeys("201910");
			Thread.sleep(2000); 
			driver.findElement(By.xpath("//label[contains(text(),'Evergreen')]")).click();
			Thread.sleep(1000); 
			driver.findElement(By.xpath("//label[contains(text(),'USAC Received Date')]")).sendKeys("12/08/2015");
			driver.findElement(By.xpath("//label[contains(text(),'USAC Received Date')]")).sendKeys(Keys.ENTER);
			Thread.sleep(2000);
			driver.findElement(By.xpath("//label[contains(text(),'Initial Due Date')]")).sendKeys("12/10/2015");
			driver.findElement(By.xpath("//label[contains(text(),'Initial Due Date')]")).sendKeys(Keys.ENTER);
			Thread.sleep(2000);
			driver.findElement(By.xpath("//label[contains(text(),'Expiration Date')]")).sendKeys("12/28/2016");
			driver.findElement(By.xpath("//label[contains(text(),'Expiration Date')]")).sendKeys(Keys.ENTER);
			Thread.sleep(2000);
			driver.findElement(By.xpath("//label[contains(text(),'Issued Date')]")).sendKeys("12/20/2016");
			driver.findElement(By.xpath("//label[contains(text(),'Issued Date')]")).sendKeys(Keys.ENTER);
			Thread.sleep(2000);
			driver.findElement(By.xpath("//label[contains(text(),'Final Revision Date')]")).sendKeys("12/20/2016");
			driver.findElement(By.xpath("//label[contains(text(),'Final Revision Date')]")).sendKeys(Keys.ENTER);
			Thread.sleep(2000);
			driver.findElement(By.xpath("//label[contains(text(),'Bank Name')]")).sendKeys("BOA");
			Thread.sleep(2000);
			driver.findElement(By.xpath("//button[contains(.,'Submit for Review')]")).click();
			Thread.sleep(4000);	
				
				
						
			
			
		}
		else 
		{
			
			driver.findElement(By.xpath("//input[@type='file']")).click();
			Thread.sleep(5000);
			robot.keyPress(KeyEvent.VK_CONTROL);
			robot.keyPress(KeyEvent.VK_V);
			robot.keyRelease(KeyEvent.VK_V);
			robot.keyRelease(KeyEvent.VK_CONTROL);
			Thread.sleep(2000);
			robot.keyPress(KeyEvent.VK_ENTER);
			Thread.sleep(1000);
			driver.findElement(By.xpath("//label[contains(text(),'LOC Number')]")).sendKeys(I);
			Thread.sleep(2000);
			driver.findElement(By.xpath("//label[contains(text(),'Yes')]")).click();
			Thread.sleep(2000);
			driver.findElement(By.xpath("//label[contains(text(),'Mobility')]")).click();
			Thread.sleep(2000);
			driver.findElement(By.xpath("//label[contains(text(),'LOC Amount')]")).sendKeys("12344245");
			Thread.sleep(1000);
			driver.findElement(By.xpath("//label[contains(text(),'LOC Description')]")).sendKeys("Sample LOC");
			Thread.sleep(1000);
			driver.findElement(By.xpath("/html/body/div[7]/div[2]/div/div[2]/div/div[2]/div[2]/div/div/div/form/div[2]/div/div/div/div/div/div/div[1]/div[3]/div/div/div[1]/div/div/div[5]/div/div/div/div[1]/div/select")).sendKeys("Payments 2&3");
			Thread.sleep(2000); 
			driver.findElement(By.xpath("//label[contains(text(),'Evergreen')]")).click();
			Thread.sleep(1000); 
			driver.findElement(By.xpath("//label[contains(text(),'USAC Received Date')]")).sendKeys("12/08/2015");
			driver.findElement(By.xpath("//label[contains(text(),'USAC Received Date')]")).sendKeys(Keys.ENTER);
			Thread.sleep(1000);
			driver.findElement(By.xpath("//label[contains(text(),'Initial Due Date')]")).sendKeys("12/10/2015");
			driver.findElement(By.xpath("//label[contains(text(),'Initial Due Date')]")).sendKeys(Keys.ENTER);
			Thread.sleep(1000);
			driver.findElement(By.xpath("//label[contains(text(),'Expiration Date')]")).sendKeys("12/28/2016");
			driver.findElement(By.xpath("//label[contains(text(),'Expiration Date')]")).sendKeys(Keys.ENTER);
			Thread.sleep(1000);
			driver.findElement(By.xpath("//label[contains(text(),'Issued Date')]")).sendKeys("12/20/2016");
			driver.findElement(By.xpath("//label[contains(text(),'Issued Date')]")).sendKeys(Keys.ENTER);
			Thread.sleep(1000);
			driver.findElement(By.xpath("//label[contains(text(),'Final Revision Date')]")).sendKeys("12/20/2016");
			driver.findElement(By.xpath("//label[contains(text(),'Final Revision Date')]")).sendKeys(Keys.ENTER);
			Thread.sleep(1000);
			driver.findElement(By.xpath("//label[contains(text(),'Bank Name')]")).sendKeys("BOA");
			Thread.sleep(1000);
			driver.findElement(By.xpath("//button[contains(.,'Submit for Review')]")).click();
			Thread.sleep(4000);
		
		}}
	
	
	
	
	@Test (priority = 4)
	public void signOutPa() throws InterruptedException, IOException {
		Thread.sleep(2000);
		driver.findElement(By.cssSelector(".appian-body .GJEWJWHDIFC")).click();
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.partialLinkText("Sign Out")).click();
	}  
	
	
	@Test (priority = 5)
	public void logInLr() throws InterruptedException {
		driver.findElement(By.cssSelector(".btn, input.iBlueButton")).click(); 
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.id("un")).sendKeys(E);
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.id("pw")).sendKeys(B);
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.xpath("//input[@type='submit']")).click();
		Thread.sleep(7000);	
		driver.findElement(By.partialLinkText("Tasks")).click();
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.partialLinkText("Review Letter of Credit (" + C + ")")).click();
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.xpath("//button[contains(.,'Accept')]")).click();
		Thread.sleep(1000);
		driver.findElement(By.xpath("//label[contains(text(),'Review Feedback')]")).sendKeys("Ready!");
		Thread.sleep(1000);
		driver.findElement(By.xpath("//button[contains(.,'Submit for Legal Decision')]")).click();
		
}
	@Test (priority = 6)
	public void signOutLr() throws InterruptedException, IOException {
		Thread.sleep(2000);
		driver.findElement(By.cssSelector(".appian-body .GJEWJWHDIFC")).click();
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.partialLinkText("Sign Out")).click();
	}
	/*
	
	@Test (priority = 7)
	public void logInLap() throws InterruptedException {
		driver.findElement(By.cssSelector(".btn, input.iBlueButton")).click(); 
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.id("un")).sendKeys(F);
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.id("pw")).sendKeys(B);
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.xpath("//input[@type='submit']")).click();
		Thread.sleep(7000);	
		driver.findElement(By.partialLinkText("Tasks")).click();
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.partialLinkText("Review and Approve Letter of Credit (" + C + ")")).click();
		Thread.sleep(1000);
		driver.findElement(By.xpath("//button[contains(.,'Accept')]")).click();
		Thread.sleep(1000);
		driver.findElement(By.xpath("//label[contains(text(),'Approve')]")).click();
		Thread.sleep(1000);
		driver.findElement(By.xpath("//label[contains(text(),'Approver Feedback')]")).sendKeys("Approved");
		Thread.sleep(1000);
		driver.findElement(By.xpath("//button[contains(.,'Submit Decision')]")).click();
		
}
	@Test (priority = 8)
	public void signOutLap() throws InterruptedException, IOException {
		Thread.sleep(2000);
		driver.findElement(By.cssSelector(".appian-body .GJEWJWHDIFC")).click();
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.partialLinkText("Sign Out")).click();
	} 
	
	
	@Test (priority = 9)
	public void logInLrEmail() throws InterruptedException, AWTException {
		Robot robot = new Robot();
		
		driver.findElement(By.cssSelector(".btn, input.iBlueButton")).click(); 
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.id("un")).sendKeys(E);
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.id("pw")).sendKeys(B);
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.xpath("//input[@type='submit']")).click();
		Thread.sleep(7000);	
		driver.findElement(By.partialLinkText("Tasks")).click();
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.partialLinkText("Edit Carrier Email (" + C + ")")).click();
		Thread.sleep(2000);
		
		driver.findElement(By.partialLinkText("Add Document")).click();
		Thread.sleep(1000);
		driver.findElement(By.xpath("//input[@type='file']")).click();
		Thread.sleep(5000);
		robot.keyPress(KeyEvent.VK_CONTROL);
		robot.keyPress(KeyEvent.VK_V);
		robot.keyRelease(KeyEvent.VK_V);
		robot.keyRelease(KeyEvent.VK_CONTROL);
		Thread.sleep(2000);
		robot.keyPress(KeyEvent.VK_ENTER);
		Thread.sleep(1000);
		
		driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
		driver.findElement(By.xpath("//label[contains(text(),'Recipients')]")).sendKeys(Keys.CONTROL + "a");
		Thread.sleep(1000);
		driver.findElement(By.xpath("//label[contains(text(),'Recipients')]")).sendKeys("usac-cap-testers@itgfirm.com");
		Thread.sleep(1000);
		driver.findElement(By.xpath("//button[contains(.,'Send Email')]")).click();
	}*/
	}
